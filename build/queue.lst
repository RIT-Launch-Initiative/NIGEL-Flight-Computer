ARM GAS  /tmp/cc8n8LHl.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"queue.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.alloc_node,"ax",%progbits
  18              		.align	1
  19              		.arch armv7e-m
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	alloc_node:
  26              	.LFB0:
  27              		.file 1 "source/modules/queue/queue.c"
   1:source/modules/queue/queue.c **** #include "stdlib.h" // malloc
   2:source/modules/queue/queue.c **** #include <stdint.h> // uint8_t
   3:source/modules/queue/queue.c **** #include "queue.h"
   4:source/modules/queue/queue.c **** 
   5:source/modules/queue/queue.c **** typedef struct {
   6:source/modules/queue/queue.c ****     void* data;
   7:source/modules/queue/queue.c ****     void* next;
   8:source/modules/queue/queue.c ****     void* prev;
   9:source/modules/queue/queue.c **** } q_node_t;
  10:source/modules/queue/queue.c **** 
  11:source/modules/queue/queue.c **** // preallocate nodes
  12:source/modules/queue/queue.c **** static q_node_t prealloc_nodes[NUM_QUEUE_NODES];
  13:source/modules/queue/queue.c **** 
  14:source/modules/queue/queue.c **** // maps which nodes are free
  15:source/modules/queue/queue.c **** // 0 = free, 1 = not
  16:source/modules/queue/queue.c **** // since this is in BSS they are all initialized to free
  17:source/modules/queue/queue.c **** static uint8_t free_nodes[NUM_QUEUE_NODES];
  18:source/modules/queue/queue.c **** 
  19:source/modules/queue/queue.c **** static q_node_t* alloc_node() {
  28              		.loc 1 19 31 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		@ link register save eliminated.
  20:source/modules/queue/queue.c ****     // search for a free node from the preallocated nodes
  21:source/modules/queue/queue.c ****     for(size_t i = 0; i < NUM_QUEUE_NODES; i++) {
  33              		.loc 1 21 5 view .LVU1
  34              	.LBB2:
  35              		.loc 1 21 9 view .LVU2
  36              	.LVL0:
  37              		.loc 1 21 16 is_stmt 0 view .LVU3
ARM GAS  /tmp/cc8n8LHl.s 			page 2


  38 0000 0023     		movs	r3, #0
  39              	.LVL1:
  40              	.L2:
  41              		.loc 1 21 25 is_stmt 1 discriminator 1 view .LVU4
  42 0002 632B     		cmp	r3, #99
  43 0004 0DD8     		bhi	.L6
  22:source/modules/queue/queue.c ****         if(!free_nodes[i]) {
  44              		.loc 1 22 9 view .LVU5
  45              		.loc 1 22 23 is_stmt 0 view .LVU6
  46 0006 084A     		ldr	r2, .L8
  47 0008 D25C     		ldrb	r2, [r2, r3]	@ zero_extendqisi2
  48              		.loc 1 22 11 view .LVU7
  49 000a 0AB1     		cbz	r2, .L7
  21:source/modules/queue/queue.c ****         if(!free_nodes[i]) {
  50              		.loc 1 21 45 is_stmt 1 discriminator 2 view .LVU8
  51 000c 0133     		adds	r3, r3, #1
  52              	.LVL2:
  21:source/modules/queue/queue.c ****         if(!free_nodes[i]) {
  53              		.loc 1 21 45 is_stmt 0 discriminator 2 view .LVU9
  54 000e F8E7     		b	.L2
  55              	.L7:
  23:source/modules/queue/queue.c ****             // mark as free
  24:source/modules/queue/queue.c ****             free_nodes[i] = 1;
  56              		.loc 1 24 13 is_stmt 1 view .LVU10
  57              		.loc 1 24 27 is_stmt 0 view .LVU11
  58 0010 054A     		ldr	r2, .L8
  59 0012 0121     		movs	r1, #1
  60 0014 D154     		strb	r1, [r2, r3]
  25:source/modules/queue/queue.c ****             return &(prealloc_nodes[i]);
  61              		.loc 1 25 13 is_stmt 1 view .LVU12
  62              		.loc 1 25 20 is_stmt 0 view .LVU13
  63 0016 03EB4303 		add	r3, r3, r3, lsl #1
  64              	.LVL3:
  65              		.loc 1 25 20 view .LVU14
  66 001a 9A00     		lsls	r2, r3, #2
  67 001c 0348     		ldr	r0, .L8+4
  68 001e 1044     		add	r0, r0, r2
  69 0020 7047     		bx	lr
  70              	.LVL4:
  71              	.L6:
  72              		.loc 1 25 20 view .LVU15
  73              	.LBE2:
  26:source/modules/queue/queue.c ****         }
  27:source/modules/queue/queue.c ****     }
  28:source/modules/queue/queue.c **** 
  29:source/modules/queue/queue.c ****     return NULL;
  74              		.loc 1 29 12 view .LVU16
  75 0022 0020     		movs	r0, #0
  30:source/modules/queue/queue.c **** }
  76              		.loc 1 30 1 view .LVU17
  77 0024 7047     		bx	lr
  78              	.L9:
  79 0026 00BF     		.align	2
  80              	.L8:
  81 0028 00000000 		.word	.LANCHOR0
  82 002c 00000000 		.word	.LANCHOR1
  83              		.cfi_endproc
ARM GAS  /tmp/cc8n8LHl.s 			page 3


  84              	.LFE0:
  86              		.section	.text.dealloc_node,"ax",%progbits
  87              		.align	1
  88              		.syntax unified
  89              		.thumb
  90              		.thumb_func
  91              		.fpu fpv4-sp-d16
  93              	dealloc_node:
  94              	.LVL5:
  95              	.LFB1:
  31:source/modules/queue/queue.c **** 
  32:source/modules/queue/queue.c **** static void dealloc_node(q_node_t* node) {
  96              		.loc 1 32 42 is_stmt 1 view -0
  97              		.cfi_startproc
  98              		@ args = 0, pretend = 0, frame = 0
  99              		@ frame_needed = 0, uses_anonymous_args = 0
 100              		@ link register save eliminated.
  33:source/modules/queue/queue.c ****     // search for which preallocated node this is
  34:source/modules/queue/queue.c ****     for(size_t i = 0; i < NUM_QUEUE_NODES; i++) {
 101              		.loc 1 34 5 view .LVU19
 102              	.LBB3:
 103              		.loc 1 34 9 view .LVU20
 104              		.loc 1 34 16 is_stmt 0 view .LVU21
 105 0000 0023     		movs	r3, #0
 106              		.loc 1 34 5 view .LVU22
 107 0002 00E0     		b	.L11
 108              	.LVL6:
 109              	.L12:
 110              		.loc 1 34 45 is_stmt 1 discriminator 2 view .LVU23
 111 0004 0133     		adds	r3, r3, #1
 112              	.LVL7:
 113              	.L11:
 114              		.loc 1 34 25 discriminator 1 view .LVU24
 115 0006 632B     		cmp	r3, #99
 116 0008 0AD8     		bhi	.L14
  35:source/modules/queue/queue.c ****         if(node == (prealloc_nodes + i)) {
 117              		.loc 1 35 9 view .LVU25
 118              		.loc 1 35 36 is_stmt 0 view .LVU26
 119 000a 03EB4301 		add	r1, r3, r3, lsl #1
 120 000e 054A     		ldr	r2, .L15
 121 0010 02EB8102 		add	r2, r2, r1, lsl #2
 122              		.loc 1 35 11 view .LVU27
 123 0014 8242     		cmp	r2, r0
 124 0016 F5D1     		bne	.L12
  36:source/modules/queue/queue.c ****             // mark it as freed
  37:source/modules/queue/queue.c ****             free_nodes[i] = 0;
 125              		.loc 1 37 13 is_stmt 1 view .LVU28
 126              		.loc 1 37 27 is_stmt 0 view .LVU29
 127 0018 034A     		ldr	r2, .L15+4
 128 001a 0021     		movs	r1, #0
 129 001c D154     		strb	r1, [r2, r3]
 130 001e F1E7     		b	.L12
 131              	.L14:
 132              		.loc 1 37 27 view .LVU30
 133              	.LBE3:
  38:source/modules/queue/queue.c ****         }
  39:source/modules/queue/queue.c ****     }
ARM GAS  /tmp/cc8n8LHl.s 			page 4


  40:source/modules/queue/queue.c ****     // otherwise an invalid address was passed in and we don't have to do anything
  41:source/modules/queue/queue.c **** }
 134              		.loc 1 41 1 view .LVU31
 135 0020 7047     		bx	lr
 136              	.L16:
 137 0022 00BF     		.align	2
 138              	.L15:
 139 0024 00000000 		.word	.LANCHOR1
 140 0028 00000000 		.word	.LANCHOR0
 141              		.cfi_endproc
 142              	.LFE1:
 144              		.section	.text.q_mkqueue,"ax",%progbits
 145              		.align	1
 146              		.global	q_mkqueue
 147              		.syntax unified
 148              		.thumb
 149              		.thumb_func
 150              		.fpu fpv4-sp-d16
 152              	q_mkqueue:
 153              	.LVL8:
 154              	.LFB2:
  42:source/modules/queue/queue.c **** 
  43:source/modules/queue/queue.c **** #ifdef DEBUG
  44:source/modules/queue/queue.c **** #include <stdio.h>
  45:source/modules/queue/queue.c **** void q_print_queue(queue_t* q) {
  46:source/modules/queue/queue.c ****     printf("head: %p\n", q->head);
  47:source/modules/queue/queue.c ****     printf("tail: %p\n\n", q->tail);
  48:source/modules/queue/queue.c **** 
  49:source/modules/queue/queue.c ****     int i = 0;
  50:source/modules/queue/queue.c ****     q_node_t* node = q->head;
  51:source/modules/queue/queue.c ****     while(node != NULL) {
  52:source/modules/queue/queue.c ****         printf("node %i --> ptr: %p data: %i next: %p prev: %p", i, node, *(int*)node->data, node->
  53:source/modules/queue/queue.c ****         printf("\n");
  54:source/modules/queue/queue.c ****         node = node->next;
  55:source/modules/queue/queue.c ****         i++;
  56:source/modules/queue/queue.c ****     }
  57:source/modules/queue/queue.c ****     printf("\n\n");
  58:source/modules/queue/queue.c **** }
  59:source/modules/queue/queue.c **** #endif
  60:source/modules/queue/queue.c **** 
  61:source/modules/queue/queue.c **** queue_t* q_mkqueue(int (*sort)(void* fst, void* snd)) {
 155              		.loc 1 61 55 is_stmt 1 view -0
 156              		.cfi_startproc
 157              		@ args = 0, pretend = 0, frame = 0
 158              		@ frame_needed = 0, uses_anonymous_args = 0
 159              		.loc 1 61 55 is_stmt 0 view .LVU33
 160 0000 10B5     		push	{r4, lr}
 161              	.LCFI0:
 162              		.cfi_def_cfa_offset 8
 163              		.cfi_offset 4, -8
 164              		.cfi_offset 14, -4
 165 0002 0446     		mov	r4, r0
  62:source/modules/queue/queue.c ****     queue_t* q = (queue_t*)malloc(sizeof(queue_t));
 166              		.loc 1 62 5 is_stmt 1 view .LVU34
 167              		.loc 1 62 28 is_stmt 0 view .LVU35
 168 0004 0C20     		movs	r0, #12
 169              	.LVL9:
ARM GAS  /tmp/cc8n8LHl.s 			page 5


 170              		.loc 1 62 28 view .LVU36
 171 0006 FFF7FEFF 		bl	malloc
 172              	.LVL10:
  63:source/modules/queue/queue.c ****     if(!q) {
 173              		.loc 1 63 5 is_stmt 1 view .LVU37
 174              		.loc 1 63 7 is_stmt 0 view .LVU38
 175 000a 0346     		mov	r3, r0
 176 000c 18B1     		cbz	r0, .L17
  64:source/modules/queue/queue.c ****         return NULL;
  65:source/modules/queue/queue.c ****     }
  66:source/modules/queue/queue.c ****     q->head = NULL;
 177              		.loc 1 66 5 is_stmt 1 view .LVU39
 178              		.loc 1 66 13 is_stmt 0 view .LVU40
 179 000e 0022     		movs	r2, #0
 180 0010 0260     		str	r2, [r0]
  67:source/modules/queue/queue.c ****     q->tail = NULL;
 181              		.loc 1 67 5 is_stmt 1 view .LVU41
 182              		.loc 1 67 13 is_stmt 0 view .LVU42
 183 0012 4260     		str	r2, [r0, #4]
  68:source/modules/queue/queue.c ****     q->sort = sort;
 184              		.loc 1 68 5 is_stmt 1 view .LVU43
 185              		.loc 1 68 13 is_stmt 0 view .LVU44
 186 0014 8460     		str	r4, [r0, #8]
  69:source/modules/queue/queue.c ****     return q;
 187              		.loc 1 69 5 is_stmt 1 view .LVU45
 188              	.L17:
  70:source/modules/queue/queue.c **** }
 189              		.loc 1 70 1 is_stmt 0 view .LVU46
 190 0016 1846     		mov	r0, r3
 191              	.LVL11:
 192              		.loc 1 70 1 view .LVU47
 193 0018 10BD     		pop	{r4, pc}
 194              		.loc 1 70 1 view .LVU48
 195              		.cfi_endproc
 196              	.LFE2:
 198              		.section	.text.q_rmqueue,"ax",%progbits
 199              		.align	1
 200              		.global	q_rmqueue
 201              		.syntax unified
 202              		.thumb
 203              		.thumb_func
 204              		.fpu fpv4-sp-d16
 206              	q_rmqueue:
 207              	.LVL12:
 208              	.LFB3:
  71:source/modules/queue/queue.c **** 
  72:source/modules/queue/queue.c **** void q_rmqueue(queue_t* q) {
 209              		.loc 1 72 28 is_stmt 1 view -0
 210              		.cfi_startproc
 211              		@ args = 0, pretend = 0, frame = 0
 212              		@ frame_needed = 0, uses_anonymous_args = 0
 213              		.loc 1 72 28 is_stmt 0 view .LVU50
 214 0000 38B5     		push	{r3, r4, r5, lr}
 215              	.LCFI1:
 216              		.cfi_def_cfa_offset 16
 217              		.cfi_offset 3, -16
 218              		.cfi_offset 4, -12
ARM GAS  /tmp/cc8n8LHl.s 			page 6


 219              		.cfi_offset 5, -8
 220              		.cfi_offset 14, -4
 221 0002 0546     		mov	r5, r0
  73:source/modules/queue/queue.c ****     q_node_t* node = (q_node_t*)q->head;
 222              		.loc 1 73 5 is_stmt 1 view .LVU51
 223              		.loc 1 73 15 is_stmt 0 view .LVU52
 224 0004 0068     		ldr	r0, [r0]
 225              	.LVL13:
  74:source/modules/queue/queue.c ****     q_node_t* next;
 226              		.loc 1 74 5 is_stmt 1 view .LVU53
  75:source/modules/queue/queue.c ****     while(node != NULL) {
 227              		.loc 1 75 5 view .LVU54
 228              		.loc 1 75 10 is_stmt 0 view .LVU55
 229 0006 03E0     		b	.L21
 230              	.L22:
  76:source/modules/queue/queue.c ****         next = node->next;
 231              		.loc 1 76 9 is_stmt 1 view .LVU56
 232              		.loc 1 76 14 is_stmt 0 view .LVU57
 233 0008 4468     		ldr	r4, [r0, #4]
 234              	.LVL14:
  77:source/modules/queue/queue.c ****         // free(node);
  78:source/modules/queue/queue.c ****         dealloc_node(node);
 235              		.loc 1 78 9 is_stmt 1 view .LVU58
 236 000a FFF7FEFF 		bl	dealloc_node
 237              	.LVL15:
  79:source/modules/queue/queue.c ****         node = next;
 238              		.loc 1 79 9 view .LVU59
 239              		.loc 1 79 14 is_stmt 0 view .LVU60
 240 000e 2046     		mov	r0, r4
 241              	.LVL16:
 242              	.L21:
  75:source/modules/queue/queue.c ****         next = node->next;
 243              		.loc 1 75 16 is_stmt 1 view .LVU61
 244 0010 0028     		cmp	r0, #0
 245 0012 F9D1     		bne	.L22
  80:source/modules/queue/queue.c ****     }
  81:source/modules/queue/queue.c ****     free(q);
 246              		.loc 1 81 5 view .LVU62
 247 0014 2846     		mov	r0, r5
 248              	.LVL17:
 249              		.loc 1 81 5 is_stmt 0 view .LVU63
 250 0016 FFF7FEFF 		bl	free
 251              	.LVL18:
  82:source/modules/queue/queue.c **** }
 252              		.loc 1 82 1 view .LVU64
 253 001a 38BD     		pop	{r3, r4, r5, pc}
 254              		.loc 1 82 1 view .LVU65
 255              		.cfi_endproc
 256              	.LFE3:
 258              		.section	.text.q_enqueue,"ax",%progbits
 259              		.align	1
 260              		.global	q_enqueue
 261              		.syntax unified
 262              		.thumb
 263              		.thumb_func
 264              		.fpu fpv4-sp-d16
 266              	q_enqueue:
ARM GAS  /tmp/cc8n8LHl.s 			page 7


 267              	.LVL19:
 268              	.LFB4:
  83:source/modules/queue/queue.c **** 
  84:source/modules/queue/queue.c **** int q_enqueue(queue_t* q, void* data) {
 269              		.loc 1 84 39 is_stmt 1 view -0
 270              		.cfi_startproc
 271              		@ args = 0, pretend = 0, frame = 0
 272              		@ frame_needed = 0, uses_anonymous_args = 0
 273              		.loc 1 84 39 is_stmt 0 view .LVU67
 274 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 275              	.LCFI2:
 276              		.cfi_def_cfa_offset 24
 277              		.cfi_offset 3, -24
 278              		.cfi_offset 4, -20
 279              		.cfi_offset 5, -16
 280              		.cfi_offset 6, -12
 281              		.cfi_offset 7, -8
 282              		.cfi_offset 14, -4
 283 0002 0546     		mov	r5, r0
 284 0004 0E46     		mov	r6, r1
  85:source/modules/queue/queue.c ****     // q_node_t* node = (q_node_t*)malloc(sizeof(q_node_t));
  86:source/modules/queue/queue.c ****     q_node_t* node = alloc_node();
 285              		.loc 1 86 5 is_stmt 1 view .LVU68
 286              		.loc 1 86 22 is_stmt 0 view .LVU69
 287 0006 FFF7FEFF 		bl	alloc_node
 288              	.LVL20:
  87:source/modules/queue/queue.c ****     if(node == NULL) {
 289              		.loc 1 87 5 is_stmt 1 view .LVU70
 290              		.loc 1 87 7 is_stmt 0 view .LVU71
 291 000a 0028     		cmp	r0, #0
 292 000c 2AD0     		beq	.L32
 293 000e 0746     		mov	r7, r0
  88:source/modules/queue/queue.c ****         return -1; // malloc failed, no memory left :(
  89:source/modules/queue/queue.c ****     }
  90:source/modules/queue/queue.c **** 
  91:source/modules/queue/queue.c ****     node->data = data;
 294              		.loc 1 91 5 is_stmt 1 view .LVU72
 295              		.loc 1 91 16 is_stmt 0 view .LVU73
 296 0010 0660     		str	r6, [r0]
  92:source/modules/queue/queue.c **** 
  93:source/modules/queue/queue.c ****     // queue is empty
  94:source/modules/queue/queue.c ****     if(q->head == NULL) {
 297              		.loc 1 94 5 is_stmt 1 view .LVU74
 298              		.loc 1 94 9 is_stmt 0 view .LVU75
 299 0012 2C68     		ldr	r4, [r5]
 300              		.loc 1 94 7 view .LVU76
 301 0014 54B1     		cbz	r4, .L34
  95:source/modules/queue/queue.c ****         node->next = NULL;
  96:source/modules/queue/queue.c ****         node->prev = NULL;
  97:source/modules/queue/queue.c ****         q->tail = node;
  98:source/modules/queue/queue.c ****         q->head = node;
  99:source/modules/queue/queue.c ****         return 1;
 100:source/modules/queue/queue.c ****     }
 101:source/modules/queue/queue.c **** 
 102:source/modules/queue/queue.c ****     // find 'n' such that 'node' should go directly before 'n'
 103:source/modules/queue/queue.c ****     q_node_t* n = q->head;
 302              		.loc 1 103 5 is_stmt 1 view .LVU77
ARM GAS  /tmp/cc8n8LHl.s 			page 8


 303              	.LVL21:
 104:source/modules/queue/queue.c ****     if(q->sort) {
 304              		.loc 1 104 5 view .LVU78
 305              		.loc 1 104 9 is_stmt 0 view .LVU79
 306 0016 AB68     		ldr	r3, [r5, #8]
 307              		.loc 1 104 7 view .LVU80
 308 0018 7BB1     		cbz	r3, .L28
 309              	.LVL22:
 310              	.L27:
 105:source/modules/queue/queue.c ****         while(n != NULL) {
 311              		.loc 1 105 17 is_stmt 1 view .LVU81
 312 001a 74B1     		cbz	r4, .L28
 106:source/modules/queue/queue.c ****             if(q->sort(n->data, data) > 0) { // new node should go after 'n'
 313              		.loc 1 106 13 view .LVU82
 314              		.loc 1 106 17 is_stmt 0 view .LVU83
 315 001c AB68     		ldr	r3, [r5, #8]
 316              		.loc 1 106 16 view .LVU84
 317 001e 3146     		mov	r1, r6
 318 0020 2068     		ldr	r0, [r4]
 319 0022 9847     		blx	r3
 320              	.LVL23:
 321              		.loc 1 106 15 view .LVU85
 322 0024 0028     		cmp	r0, #0
 323 0026 08DD     		ble	.L28
 107:source/modules/queue/queue.c ****                 n = n->next;
 324              		.loc 1 107 17 is_stmt 1 view .LVU86
 325              		.loc 1 107 19 is_stmt 0 view .LVU87
 326 0028 6468     		ldr	r4, [r4, #4]
 327              	.LVL24:
 328              		.loc 1 107 19 view .LVU88
 329 002a F6E7     		b	.L27
 330              	.LVL25:
 331              	.L34:
  95:source/modules/queue/queue.c ****         node->prev = NULL;
 332              		.loc 1 95 9 is_stmt 1 view .LVU89
  95:source/modules/queue/queue.c ****         node->prev = NULL;
 333              		.loc 1 95 20 is_stmt 0 view .LVU90
 334 002c 0023     		movs	r3, #0
 335 002e 4360     		str	r3, [r0, #4]
  96:source/modules/queue/queue.c ****         q->tail = node;
 336              		.loc 1 96 9 is_stmt 1 view .LVU91
  96:source/modules/queue/queue.c ****         q->tail = node;
 337              		.loc 1 96 20 is_stmt 0 view .LVU92
 338 0030 8360     		str	r3, [r0, #8]
  97:source/modules/queue/queue.c ****         q->head = node;
 339              		.loc 1 97 9 is_stmt 1 view .LVU93
  97:source/modules/queue/queue.c ****         q->head = node;
 340              		.loc 1 97 17 is_stmt 0 view .LVU94
 341 0032 6860     		str	r0, [r5, #4]
  98:source/modules/queue/queue.c ****         return 1;
 342              		.loc 1 98 9 is_stmt 1 view .LVU95
  98:source/modules/queue/queue.c ****         return 1;
 343              		.loc 1 98 17 is_stmt 0 view .LVU96
 344 0034 2860     		str	r0, [r5]
  99:source/modules/queue/queue.c ****     }
 345              		.loc 1 99 9 is_stmt 1 view .LVU97
  99:source/modules/queue/queue.c ****     }
ARM GAS  /tmp/cc8n8LHl.s 			page 9


 346              		.loc 1 99 16 is_stmt 0 view .LVU98
 347 0036 0120     		movs	r0, #1
 348              	.LVL26:
  99:source/modules/queue/queue.c ****     }
 349              		.loc 1 99 16 view .LVU99
 350 0038 08E0     		b	.L24
 351              	.LVL27:
 352              	.L28:
 108:source/modules/queue/queue.c ****             } else {
 109:source/modules/queue/queue.c ****                 break;
 110:source/modules/queue/queue.c ****             }
 111:source/modules/queue/queue.c ****         }
 112:source/modules/queue/queue.c ****     }
 113:source/modules/queue/queue.c **** 
 114:source/modules/queue/queue.c ****     // new node goes on last
 115:source/modules/queue/queue.c ****     if(n == NULL) {
 353              		.loc 1 115 5 is_stmt 1 view .LVU100
 354              		.loc 1 115 7 is_stmt 0 view .LVU101
 355 003a 44B1     		cbz	r4, .L35
 116:source/modules/queue/queue.c ****         node->prev = q->tail;
 117:source/modules/queue/queue.c ****         node->next = NULL;
 118:source/modules/queue/queue.c ****         ((q_node_t*)q->tail)->next = node;
 119:source/modules/queue/queue.c ****         q->tail = node;
 120:source/modules/queue/queue.c ****     } else {
 121:source/modules/queue/queue.c ****         if(n == q->head) {
 356              		.loc 1 121 9 is_stmt 1 view .LVU102
 357              		.loc 1 121 18 is_stmt 0 view .LVU103
 358 003c 2B68     		ldr	r3, [r5]
 359              		.loc 1 121 11 view .LVU104
 360 003e A342     		cmp	r3, r4
 361 0040 0ED0     		beq	.L36
 362              	.L31:
 122:source/modules/queue/queue.c ****             q->head = node;
 123:source/modules/queue/queue.c ****         }
 124:source/modules/queue/queue.c ****         node->next = n;
 363              		.loc 1 124 9 is_stmt 1 view .LVU105
 364              		.loc 1 124 20 is_stmt 0 view .LVU106
 365 0042 7C60     		str	r4, [r7, #4]
 125:source/modules/queue/queue.c ****         node->prev = n->prev;
 366              		.loc 1 125 9 is_stmt 1 view .LVU107
 367              		.loc 1 125 23 is_stmt 0 view .LVU108
 368 0044 A368     		ldr	r3, [r4, #8]
 369              		.loc 1 125 20 view .LVU109
 370 0046 BB60     		str	r3, [r7, #8]
 126:source/modules/queue/queue.c ****         n->prev = node;
 371              		.loc 1 126 9 is_stmt 1 view .LVU110
 372              		.loc 1 126 17 is_stmt 0 view .LVU111
 373 0048 A760     		str	r7, [r4, #8]
 127:source/modules/queue/queue.c ****     }
 128:source/modules/queue/queue.c **** 
 129:source/modules/queue/queue.c ****     return 1;
 374              		.loc 1 129 12 view .LVU112
 375 004a 0120     		movs	r0, #1
 376              	.LVL28:
 377              	.L24:
 130:source/modules/queue/queue.c **** }
 378              		.loc 1 130 1 view .LVU113
ARM GAS  /tmp/cc8n8LHl.s 			page 10


 379 004c F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 380              	.LVL29:
 381              	.L35:
 116:source/modules/queue/queue.c ****         node->next = NULL;
 382              		.loc 1 116 9 is_stmt 1 view .LVU114
 116:source/modules/queue/queue.c ****         node->next = NULL;
 383              		.loc 1 116 23 is_stmt 0 view .LVU115
 384 004e 6B68     		ldr	r3, [r5, #4]
 116:source/modules/queue/queue.c ****         node->next = NULL;
 385              		.loc 1 116 20 view .LVU116
 386 0050 BB60     		str	r3, [r7, #8]
 117:source/modules/queue/queue.c ****         ((q_node_t*)q->tail)->next = node;
 387              		.loc 1 117 9 is_stmt 1 view .LVU117
 117:source/modules/queue/queue.c ****         ((q_node_t*)q->tail)->next = node;
 388              		.loc 1 117 20 is_stmt 0 view .LVU118
 389 0052 0023     		movs	r3, #0
 390 0054 7B60     		str	r3, [r7, #4]
 118:source/modules/queue/queue.c ****         q->tail = node;
 391              		.loc 1 118 9 is_stmt 1 view .LVU119
 118:source/modules/queue/queue.c ****         q->tail = node;
 392              		.loc 1 118 22 is_stmt 0 view .LVU120
 393 0056 6B68     		ldr	r3, [r5, #4]
 118:source/modules/queue/queue.c ****         q->tail = node;
 394              		.loc 1 118 36 view .LVU121
 395 0058 5F60     		str	r7, [r3, #4]
 119:source/modules/queue/queue.c ****     } else {
 396              		.loc 1 119 9 is_stmt 1 view .LVU122
 119:source/modules/queue/queue.c ****     } else {
 397              		.loc 1 119 17 is_stmt 0 view .LVU123
 398 005a 6F60     		str	r7, [r5, #4]
 129:source/modules/queue/queue.c **** }
 399              		.loc 1 129 12 view .LVU124
 400 005c 0120     		movs	r0, #1
 401 005e F5E7     		b	.L24
 402              	.L36:
 122:source/modules/queue/queue.c ****         }
 403              		.loc 1 122 13 is_stmt 1 view .LVU125
 122:source/modules/queue/queue.c ****         }
 404              		.loc 1 122 21 is_stmt 0 view .LVU126
 405 0060 2F60     		str	r7, [r5]
 406 0062 EEE7     		b	.L31
 407              	.LVL30:
 408              	.L32:
  88:source/modules/queue/queue.c ****     }
 409              		.loc 1 88 16 view .LVU127
 410 0064 4FF0FF30 		mov	r0, #-1
 411              	.LVL31:
  88:source/modules/queue/queue.c ****     }
 412              		.loc 1 88 16 view .LVU128
 413 0068 F0E7     		b	.L24
 414              		.cfi_endproc
 415              	.LFE4:
 417              		.section	.text.q_dequeue,"ax",%progbits
 418              		.align	1
 419              		.global	q_dequeue
 420              		.syntax unified
 421              		.thumb
ARM GAS  /tmp/cc8n8LHl.s 			page 11


 422              		.thumb_func
 423              		.fpu fpv4-sp-d16
 425              	q_dequeue:
 426              	.LVL32:
 427              	.LFB5:
 131:source/modules/queue/queue.c **** 
 132:source/modules/queue/queue.c **** void* q_dequeue(queue_t* q) {
 428              		.loc 1 132 29 is_stmt 1 view -0
 429              		.cfi_startproc
 430              		@ args = 0, pretend = 0, frame = 0
 431              		@ frame_needed = 0, uses_anonymous_args = 0
 432              		.loc 1 132 29 is_stmt 0 view .LVU130
 433 0000 38B5     		push	{r3, r4, r5, lr}
 434              	.LCFI3:
 435              		.cfi_def_cfa_offset 16
 436              		.cfi_offset 3, -16
 437              		.cfi_offset 4, -12
 438              		.cfi_offset 5, -8
 439              		.cfi_offset 14, -4
 440 0002 0446     		mov	r4, r0
 133:source/modules/queue/queue.c ****     if(q->tail == NULL) {
 441              		.loc 1 133 5 is_stmt 1 view .LVU131
 442              		.loc 1 133 9 is_stmt 0 view .LVU132
 443 0004 4068     		ldr	r0, [r0, #4]
 444              	.LVL33:
 445              		.loc 1 133 7 view .LVU133
 446 0006 90B1     		cbz	r0, .L40
 134:source/modules/queue/queue.c ****         return NULL;
 135:source/modules/queue/queue.c ****     }
 136:source/modules/queue/queue.c **** 
 137:source/modules/queue/queue.c ****     void* ret = ((q_node_t*)q->tail)->data;
 447              		.loc 1 137 5 is_stmt 1 view .LVU134
 448              		.loc 1 137 11 is_stmt 0 view .LVU135
 449 0008 0568     		ldr	r5, [r0]
 450              	.LVL34:
 138:source/modules/queue/queue.c **** 
 139:source/modules/queue/queue.c ****     // only one element
 140:source/modules/queue/queue.c ****     if(q->head == q->tail) {
 451              		.loc 1 140 5 is_stmt 1 view .LVU136
 452              		.loc 1 140 9 is_stmt 0 view .LVU137
 453 000a 2368     		ldr	r3, [r4]
 454              		.loc 1 140 7 view .LVU138
 455 000c 9842     		cmp	r0, r3
 456 000e 07D0     		beq	.L42
 141:source/modules/queue/queue.c ****         // free(q->head);
 142:source/modules/queue/queue.c ****         dealloc_node(q->head);
 143:source/modules/queue/queue.c ****         q->head = NULL;
 144:source/modules/queue/queue.c ****         q->tail = NULL;
 145:source/modules/queue/queue.c ****         return ret;
 146:source/modules/queue/queue.c ****     }
 147:source/modules/queue/queue.c **** 
 148:source/modules/queue/queue.c ****     q_node_t* old_tail = q->tail;
 457              		.loc 1 148 5 is_stmt 1 view .LVU139
 458              	.LVL35:
 149:source/modules/queue/queue.c ****     q->tail = old_tail->prev;
 459              		.loc 1 149 5 view .LVU140
 460              		.loc 1 149 23 is_stmt 0 view .LVU141
ARM GAS  /tmp/cc8n8LHl.s 			page 12


 461 0010 8368     		ldr	r3, [r0, #8]
 462              		.loc 1 149 13 view .LVU142
 463 0012 6360     		str	r3, [r4, #4]
 150:source/modules/queue/queue.c ****     ((q_node_t*)q->tail)->next = NULL;
 464              		.loc 1 150 5 is_stmt 1 view .LVU143
 465              		.loc 1 150 32 is_stmt 0 view .LVU144
 466 0014 0022     		movs	r2, #0
 467 0016 5A60     		str	r2, [r3, #4]
 151:source/modules/queue/queue.c **** 
 152:source/modules/queue/queue.c ****     // free(old_tail);
 153:source/modules/queue/queue.c ****     dealloc_node(old_tail);
 468              		.loc 1 153 5 is_stmt 1 view .LVU145
 469 0018 FFF7FEFF 		bl	dealloc_node
 470              	.LVL36:
 154:source/modules/queue/queue.c **** 
 155:source/modules/queue/queue.c ****     return ret;
 471              		.loc 1 155 5 view .LVU146
 472              	.L37:
 156:source/modules/queue/queue.c **** }
 473              		.loc 1 156 1 is_stmt 0 view .LVU147
 474 001c 2846     		mov	r0, r5
 475 001e 38BD     		pop	{r3, r4, r5, pc}
 476              	.LVL37:
 477              	.L42:
 142:source/modules/queue/queue.c ****         q->head = NULL;
 478              		.loc 1 142 9 is_stmt 1 view .LVU148
 479 0020 1846     		mov	r0, r3
 480 0022 FFF7FEFF 		bl	dealloc_node
 481              	.LVL38:
 143:source/modules/queue/queue.c ****         q->tail = NULL;
 482              		.loc 1 143 9 view .LVU149
 143:source/modules/queue/queue.c ****         q->tail = NULL;
 483              		.loc 1 143 17 is_stmt 0 view .LVU150
 484 0026 0023     		movs	r3, #0
 485 0028 2360     		str	r3, [r4]
 144:source/modules/queue/queue.c ****         return ret;
 486              		.loc 1 144 9 is_stmt 1 view .LVU151
 144:source/modules/queue/queue.c ****         return ret;
 487              		.loc 1 144 17 is_stmt 0 view .LVU152
 488 002a 6360     		str	r3, [r4, #4]
 145:source/modules/queue/queue.c ****     }
 489              		.loc 1 145 9 is_stmt 1 view .LVU153
 145:source/modules/queue/queue.c ****     }
 490              		.loc 1 145 16 is_stmt 0 view .LVU154
 491 002c F6E7     		b	.L37
 492              	.LVL39:
 493              	.L40:
 134:source/modules/queue/queue.c ****     }
 494              		.loc 1 134 16 view .LVU155
 495 002e 0546     		mov	r5, r0
 496 0030 F4E7     		b	.L37
 497              		.cfi_endproc
 498              	.LFE5:
 500              		.section	.text.q_peek,"ax",%progbits
 501              		.align	1
 502              		.global	q_peek
 503              		.syntax unified
ARM GAS  /tmp/cc8n8LHl.s 			page 13


 504              		.thumb
 505              		.thumb_func
 506              		.fpu fpv4-sp-d16
 508              	q_peek:
 509              	.LVL40:
 510              	.LFB6:
 157:source/modules/queue/queue.c **** 
 158:source/modules/queue/queue.c **** void* q_peek(queue_t* q) {
 511              		.loc 1 158 26 is_stmt 1 view -0
 512              		.cfi_startproc
 513              		@ args = 0, pretend = 0, frame = 0
 514              		@ frame_needed = 0, uses_anonymous_args = 0
 515              		@ link register save eliminated.
 159:source/modules/queue/queue.c ****     if(q->tail == NULL) {
 516              		.loc 1 159 5 view .LVU157
 517              		.loc 1 159 9 is_stmt 0 view .LVU158
 518 0000 4068     		ldr	r0, [r0, #4]
 519              	.LVL41:
 520              		.loc 1 159 7 view .LVU159
 521 0002 00B1     		cbz	r0, .L43
 160:source/modules/queue/queue.c ****         return NULL;
 161:source/modules/queue/queue.c ****     }
 162:source/modules/queue/queue.c **** 
 163:source/modules/queue/queue.c ****     return ((q_node_t*)q->tail)->data;
 522              		.loc 1 163 5 is_stmt 1 view .LVU160
 523              		.loc 1 163 32 is_stmt 0 view .LVU161
 524 0004 0068     		ldr	r0, [r0]
 525              	.L43:
 164:source/modules/queue/queue.c **** }
 526              		.loc 1 164 1 view .LVU162
 527 0006 7047     		bx	lr
 528              		.cfi_endproc
 529              	.LFE6:
 531              		.section	.bss.free_nodes,"aw",%nobits
 532              		.align	2
 533              		.set	.LANCHOR0,. + 0
 536              	free_nodes:
 537 0000 00000000 		.space	100
 537      00000000 
 537      00000000 
 537      00000000 
 537      00000000 
 538              		.section	.bss.prealloc_nodes,"aw",%nobits
 539              		.align	2
 540              		.set	.LANCHOR1,. + 0
 543              	prealloc_nodes:
 544 0000 00000000 		.space	1200
 544      00000000 
 544      00000000 
 544      00000000 
 544      00000000 
 545              		.text
 546              	.Letext0:
 547              		.file 2 "/usr/lib/gcc/arm-none-eabi/11.2.0/include/stddef.h"
 548              		.file 3 "/usr/arm-none-eabi/include/machine/_default_types.h"
 549              		.file 4 "/usr/arm-none-eabi/include/sys/_stdint.h"
 550              		.file 5 "source/modules/queue/queue.h"
ARM GAS  /tmp/cc8n8LHl.s 			page 14


 551              		.file 6 "/usr/arm-none-eabi/include/stdlib.h"
ARM GAS  /tmp/cc8n8LHl.s 			page 15


DEFINED SYMBOLS
                            *ABS*:0000000000000000 queue.c
     /tmp/cc8n8LHl.s:18     .text.alloc_node:0000000000000000 $t
     /tmp/cc8n8LHl.s:25     .text.alloc_node:0000000000000000 alloc_node
     /tmp/cc8n8LHl.s:81     .text.alloc_node:0000000000000028 $d
     /tmp/cc8n8LHl.s:87     .text.dealloc_node:0000000000000000 $t
     /tmp/cc8n8LHl.s:93     .text.dealloc_node:0000000000000000 dealloc_node
     /tmp/cc8n8LHl.s:139    .text.dealloc_node:0000000000000024 $d
     /tmp/cc8n8LHl.s:145    .text.q_mkqueue:0000000000000000 $t
     /tmp/cc8n8LHl.s:152    .text.q_mkqueue:0000000000000000 q_mkqueue
     /tmp/cc8n8LHl.s:199    .text.q_rmqueue:0000000000000000 $t
     /tmp/cc8n8LHl.s:206    .text.q_rmqueue:0000000000000000 q_rmqueue
     /tmp/cc8n8LHl.s:259    .text.q_enqueue:0000000000000000 $t
     /tmp/cc8n8LHl.s:266    .text.q_enqueue:0000000000000000 q_enqueue
     /tmp/cc8n8LHl.s:418    .text.q_dequeue:0000000000000000 $t
     /tmp/cc8n8LHl.s:425    .text.q_dequeue:0000000000000000 q_dequeue
     /tmp/cc8n8LHl.s:501    .text.q_peek:0000000000000000 $t
     /tmp/cc8n8LHl.s:508    .text.q_peek:0000000000000000 q_peek
     /tmp/cc8n8LHl.s:532    .bss.free_nodes:0000000000000000 $d
     /tmp/cc8n8LHl.s:536    .bss.free_nodes:0000000000000000 free_nodes
     /tmp/cc8n8LHl.s:539    .bss.prealloc_nodes:0000000000000000 $d
     /tmp/cc8n8LHl.s:543    .bss.prealloc_nodes:0000000000000000 prealloc_nodes

UNDEFINED SYMBOLS
malloc
free
